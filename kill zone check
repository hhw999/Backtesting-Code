import pandas as pd
import yfinance as yf
import mplfinance as mpf
from backtesting import Backtest, Strategy
from backtesting.lib import crossover, plot_heatmaps, resample_apply, barssince
from datetime import time

min15_data = yf.download(tickers='GBPUSD=X', start="2023-7-20", end="2023-8-15", interval='15m')

# print(min15_data.to_string())

def check_time_range(timestamp):
    """Function to check if current bar is within kill zone."""
    # Extract the time from the timestamp
    current_time = timestamp.time()

    # Define time ranges
    time_range_1_start = time(8, 0)
    time_range_1_end = time(10, 30)
    time_range_2_start = time(12, 30)
    time_range_2_end = time(15, 0)

    # Check if the time is within either of the defined ranges
    if (time_range_1_start <= current_time <= time_range_1_end) or \
       (time_range_2_start <= current_time <= time_range_2_end):
        return True
    else:
        return False

for timestamp in min15_data.index:
    if check_time_range(timestamp):
        print(f"Timestamp {timestamp} is within the kill zone.")
    else:
        print('no')
